<table>
  <tr>
    <th colspan="3">Annualised Credit</th>
    <td colspan="2"><input id = "annualised_credit" type="number" name="annualised_credit" class="form_apply form-control"  readonly /></td>
    <th colspan="1">L.Y T/o</th>
    <td colspan="1"><input id = "ly_to" type="number" name="ly_to" class="form_apply form-control" readonly /></td>
    <th>I/w</th>
    <td colspan="1"><input id = "iw" type="number" name="iw" class="form_apply form-control" readonly /></td>
    <th>O/w</th>
    <td colspan="1"><input id = "ow" type="number" name="ow" class="form_apply form-control" readonly  /></td>
    <th>BTO</th>
    <td colspan="2"><input id = "bto" type="number" name="bto" class="form_apply form-control"  readonly/></td>
    <!--<th><input type="text" name="ac_holder_name" class="form_apply form-control" pattern="[a-zA-Z0-9\s]+" required/></th> -->
  </tr>
  <tr>
    <td rowspan="2">Month</td>
    <td rowspan="2">Inflow (Credit)</td>
    <td rowspan="2">Credit Entries</td>
    <td rowspan="2">Debit Entries</td>
    <td rowspan="2">O/w Return</td>
    <td rowspan="2">I/W Return</td>
    <td colspan="6">Banking Utilization</td>
    <td rowspan="2">ABB</td>
    <td rowspan="2">ABB/ Our EMI</td>
  </tr>
  <tr>
    <td>1st</td>
    <td>5th</td>
    <td>10th</td>
    <td>15th</td>
    <td>20th</td>
    <td>25th</td>
  </tr>
  <tr>
    <td><input id = "month1" type="number" name="month1" class="form_apply form-control"  /></td>
    <td><input id = "credit_sum1" type="number" name="credit_sum1" class="form_apply form-control"  /></td>
    <td><input id = "credit_entries1" type="number" name="credit_entries1" class="form_apply form-control"  /></td>                                                                                    
    <td><input id = "debit_entry_1" type="number" name="debit_entry_1" class="form_apply form-control"  /></td>
    <td><input id = "ow_return1" type="number" name="ow_return1" class="form_apply form-control"  /></td>
    <td><input id = "iw_return1" type="number" name="iw_return1" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_1_1" type="number" name="banking_usiliz_1_1" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_5_1" type="number" name="banking_usiliz_5_1" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_10_1" type="number" name="banking_usiliz_10_1" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_15_1" type="number" name="banking_usiliz_5_1" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_20_1" type="number" name="banking_usiliz_20_1" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_25_1" type="number" name="banking_usiliz_25_1" class="form_apply form-control"  /></td>
    <td><input id = "abb1" type="number" name="abb1" class="form_apply form-control"  readonly/></td>
    <td><input id = "abb_emi1" type="number" name="abb_emi1" class="form_apply form-control" readonly /></td>
  </tr>
<tr>
    <td><input id = "month2" type="number" name="month2" class="form_apply form-control"  /></td>
    <td><input id = "credit_sum2" type="number" name="credit_sum2" class="form_apply form-control"  /></td>
    <td><input id = "credit_entries2" type="number" name="credit_entries2" class="form_apply form-control"></td>                                                                                    
    <td><input id = "debit_entry_2" type="number" name="debit_entry_2" class="form_apply form-control"  /></td>
    <td><input id = "ow_return2" type="number" name="ow_return2" class="form_apply form-control"  /></td>
    <td><input id = "iw_return2" type="number" name="iw_return2" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_1_2" type="number" name="banking_usiliz_1_2" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_5_2" type="number" name="banking_usiliz_5_2" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_10_2" type="number" name="banking_usiliz_10_2" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_15_2" type="number" name="banking_usiliz_15_2" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_20_2" type="number" name="banking_usiliz_20_2" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_25_2" type="number" name="banking_usiliz_25_2" class="form_apply form-control"  /></td>
    <td><input id = "abb2" type="number" name="abb2" class="form_apply form-control"  readonly/></td>
    <td><input id = "abb_emi2" type="number" name="abb_emi2" class="form_apply form-control"  readonly/></td>
  </tr>
 <tr>
    <td><input id = "month3" type="number" name="month3" class="form_apply form-control"  /></td>
    <td><input id = "credit_sum3" type="number" name="credit_sum3" class="form_apply form-control"  /></td>
    <td><input id = "credit_entries3" type="number" name="credit_entries3" class="form_apply form-control"></td>                                                                                    
    <td><input id = "debit_entry_3" type="number" name="debit_entry_3" class="form_apply form-control"  /></td>
    <td><input id = "ow_return3" type="number" name="ow_return3" class="form_apply form-control"  /></td>
    <td><input id = "iw_return3" type="number" name="iw_return3" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_1_3" type="number" name="banking_usiliz_1_3" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_5_3" type="number" name="banking_usiliz_5_3" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_10_3" type="number" name="banking_usiliz_10_3" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_15_3" type="number" name="banking_usiliz_15_3" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_20_3" type="number" name="banking_usiliz_20_3" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_25_3" type="number" name="banking_usiliz_25_3" class="form_apply form-control"  /></td>
    <td><input id = "abb3" type="number" name="abb3" class="form_apply form-control"  readonly/></td>
    <td><input id = "abb_emi3" type="number" name="abb_emi3" class="form_apply form-control"  readonly/></td>
  </tr>
  <tr>
    <td><input id = "month4" type="number" name="month4" class="form_apply form-control"  /></td>
    <td><input id = "credit_sum4" type="number" name="credit_sum4" class="form_apply form-control"  /></td>
    <td><input id = "credit_entries4" type="number" name="credit_entries4" class="form_apply form-control"></td>                                                                                    
    <td><input id = "debit_entry_4" type="number" name="debit_entry_4" class="form_apply form-control"  /></td>
    <td><input id = "ow_return4" type="number" name="ow_return4" class="form_apply form-control"  /></td>
    <td><input id = "iw_return4" type="number" name="iw_return4" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_1_4" type="number" name="banking_usiliz_1_4" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_5_4" type="number" name="banking_usiliz_5_4" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_10_4" type="number" name="banking_usiliz_10_4" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_15_4" type="number" name="banking_usiliz_15_4" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_20_4" type="number" name="banking_usiliz_20_4" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_25_4" type="number" name="banking_usiliz_25_4" class="form_apply form-control"  /></td>
    <td><input id = "abb4" type="number" name="abb4" class="form_apply form-control"  readonly/></td>
    <td><input id = "abb_emi4" type="number" name="abb_emi4" class="form_apply form-control"  readonly/></td>
  </tr>
  <tr>
    <td><input id = "month5" type="number" name="month5" class="form_apply form-control"  /></td>
    <td><input id = "credit_sum5" type="number" name="credit_sum5" class="form_apply form-control"  /></td>
    <td><input id = "credit_entries5" type="number" name="credit_entries5" class="form_apply form-control"></td>                                                                                    
    <td><input id = "debit_entry_5" type="number" name="debit_entry_5" class="form_apply form-control"  /></td>
    <td><input id = "ow_return5" type="number" name="ow_return5" class="form_apply form-control"  /></td>
    <td><input id = "iw_return5" type="number" name="iw_return5" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_1_5" type="number" name="banking_usiliz_1_5" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_5_5" type="number" name="banking_usiliz_5_5" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_10_5" type="number" name="banking_usiliz_10_5" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_15_5" type="number" name="banking_usiliz_15_5" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_20_5" type="number" name="banking_usiliz_20_5" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_25_5" type="number" name="banking_usiliz_25_5" class="form_apply form-control"  /></td>
    <td><input id = "abb5" type="number" name="abb5" class="form_apply form-control"  readonly/></td>
    <td><input id = "abb_emi5" type="number" name="abb_emi5" class="form_apply form-control"  readonly/></td>
  </tr>
  <tr>
    <td><input id = "month6" type="number" name="month6" class="form_apply form-control"  /></td>
    <td><input id = "credit_sum6" type="number" name="credit_sum6" class="form_apply form-control"  /></td>
    <td><input id = "credit_entries6" type="number" name="credit_entries6" class="form_apply form-control"></td>                                                                                    
    <td><input id = "debit_entry_6" type="number" name="debit_entry_6" class="form_apply form-control"  /></td>
    <td><input id = "ow_return6" type="number" name="ow_return6" class="form_apply form-control"  /></td>
    <td><input id = "iw_return6" type="number" name="iw_return6" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_1_6" type="number" name="banking_usiliz_1_6" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_5_6" type="number" name="banking_usiliz_5_6" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_10_6" type="number" name="banking_usiliz_10_6" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_15_6" type="number" name="banking_usiliz_15_6" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_20_6" type="number" name="banking_usiliz_20_6" class="form_apply form-control"  /></td>
    <td><input id = "banking_usiliz_25_6" type="number" name="banking_usiliz_25_6" class="form_apply form-control"  /></td>
    <td><input id = "abb6" type="number" name="abb6" class="form_apply form-control"  readonly/></td>
    <td><input id = "abb_emi6" type="number" name="abb_emi6" class="form_apply form-control" readonly /></td>
  </tr>
</table>

<script >

  document.querySelectorAll('.form_apply').forEach(item => {
  item.addEventListener('input', event => {
    bank_calculation();
  })
})
  

function bank_calculation(){

     //Annualised Credit
     var m1 = parseInt(document.getElementById("credit_sum1").value || 0);
     var m2 = parseInt(document.getElementById("credit_sum2").value || 0);
     var m3 = parseInt(document.getElementById("credit_sum3").value || 0);
     var m4 = parseInt(document.getElementById("credit_sum4").value || 0);
     var m5 = parseInt(document.getElementById("credit_sum5").value || 0);
     var m6 = parseInt(document.getElementById("credit_sum6").value || 0);

     var anual_cred = m1 + m2 + m3 + m4 + m5 + m6;

     document.getElementById("annualised_credit").value = Math.round(anual_cred);


     //ABB
     var ab1 = parseInt(document.getElementById("banking_usiliz_1_1").value || 0);
     var ab2 = parseInt(document.getElementById("banking_usiliz_5_1").value || 0);
     var ab3 = parseInt(document.getElementById("banking_usiliz_10_1").value || 0);
     var ab4 = parseInt(document.getElementById("banking_usiliz_15_1").value || 0);
     var ab5 = parseInt(document.getElementById("banking_usiliz_20_1").value || 0);
     var ab6 = parseInt(document.getElementById("banking_usiliz_25_1").value || 0);
     var nonblanks = [];
     var nonblankfinal = [];
     nonblanks.push(ab1,ab2,ab3,ab4,ab5,ab6);
     nonblankfinal = nonblanks.filter(cv => cv != "0")
     var nonblank = nonblankfinal.length;
     var abb = ((ab1 + ab2 + ab3 + ab4 + ab5 + ab6)/nonblank);
     document.getElementById("abb1").value = Math.round(abb);


     //I/w Return (%)
     var de1 = parseInt(document.getElementById("debit_entry_1").value || 0);
     var de2 = parseInt(document.getElementById("debit_entry_2").value || 0);
     var de3 = parseInt(document.getElementById("debit_entry_3").value || 0);
     var de4 = parseInt(document.getElementById("debit_entry_4").value || 0);
     var de5 = parseInt(document.getElementById("debit_entry_5").value || 0);
     var de6 = parseInt(document.getElementById("debit_entry_6").value || 0);

     var iw1 = parseInt(document.getElementById("iw_return1").value || 0);
     var iw2 = parseInt(document.getElementById("iw_return2").value || 0);
     var iw3 = parseInt(document.getElementById("iw_return3").value || 0);
     var iw4 = parseInt(document.getElementById("iw_return4").value || 0);
     var iw5 = parseInt(document.getElementById("iw_return5").value || 0);
     var iw6 = parseInt(document.getElementById("iw_return6").value || 0);

     var de_sum = de1 + de2 + de3 + de4 + de5 + de6;
     var iw_sum = iw1 + iw2 + iw3 + iw4 + iw5 + iw6;
     var i_w_ret = (iw_sum/de_sum);
     document.getElementById("iw").value = i_w_ret.toFixed(1);

     
     //O/w  
     var ce1 = parseInt(document.getElementById("credit_entries1").value || 0);
     var ce2 = parseInt(document.getElementById("credit_entries2").value || 0);
     var ce3 = parseInt(document.getElementById("credit_entries3").value || 0);
     var ce4 = parseInt(document.getElementById("credit_entries4").value || 0);
     var ce5 = parseInt(document.getElementById("credit_entries5").value || 0);
     var ce6 = parseInt(document.getElementById("credit_entries6").value || 0);

     var ow1 = parseInt(document.getElementById("ow_return1").value || 0);
     var ow2 = parseInt(document.getElementById("ow_return2").value || 0);
     var ow3 = parseInt(document.getElementById("ow_return3").value || 0);
     var ow4 = parseInt(document.getElementById("ow_return4").value || 0);
     var ow5 = parseInt(document.getElementById("ow_return5").value || 0);
     var ow6 = parseInt(document.getElementById("ow_return6").value || 0);

     var cr_sum = ce1 + ce2 + ce3 + ce4 + ce5 + ce6;
     var ow_sum = ow1 + ow2 + ow3 + ow4 + ow5 + ow6;
     var o_w_ret = (iw_sum/de_sum);
     document.getElementById("ow").value = o_w_ret.toFixed(1);



}



</script>